---
layout: post
title: CS Study 03 - OSI 7 Layer & 3/4-way handshaking
---

# OSI 7 Layer

---

네트워크에서 통신이 일어나는 과정을 7단계로 나눈 것. 7개로 나누는 경우 7 Layer 라고 하며, 4개로 나누는 경우 4 Layer라고 한다.

+--------------------------------------+--------------------------------------+<br>
| Layer 7 : 응용 계층 | |<br>
+--------------------------------------+ |<br>
| Layer 6 : 표현 계층 | Layer 4 : 응용 계층 |<br>
+--------------------------------------+ |<br>
| Layer 5 : 세션 계층 | |<br>
+--------------------------------------+--------------------------------------+<br>
| Layer 4 : 전송 계층 | Layer 3 : 전송 계층 |<br>
+--------------------------------------+--------------------------------------+<br>
| Layer 3 : 네트워크 계층 | Layer 2 : 인터넷 계층 |<br>
+--------------------------------------+--------------------------------------+<br>
| Layer 2 : 데이터 링크 계층 | |<br>
+--------------------------------------+ Layer 1 : 네트워크 엑세스 |<br>
| Layer 1 : 물리 계층 | |<br>
+--------------------------------------+--------------------------------------+<br>

#### Layer 1 : 물리 계층(Physical Layer)

디지털을 아날로그로 바꾸어주는 계층이다. 물리적 신호를 데이터로 바꾸어주는 역할. 단순히 데이터를 전달하는 기능만 있으며, 다른 기능은 없다.<br>
비트레이트 조절 역시 여기서 이루어지며, 전이중 통신(full duplex), 반이중 통신(half duplex), 단방향 통신(simplex) 역시 여기서 결정할 수 있다.<br>
데이터 단위는 비트이다.<br>
허브, 랜카드, 리피터 등등이 Layer 1에 포함된다.

#### Layer 2 : 데이터 링크 계층(Data Link Layer)

인접한 노드 간 신뢰성 있는 데이터 전송을 제어한다.(Node-to-Node-delivery)<br>
IEEE 802 표준에 의하면 2개의 서브 계층으로 나누어진다.<br>
MAC(Media Access Control) layer : 네크워크 상의 컴퓨터에 고유 식별자 및 액세스 제어를 제공한다. 미디어에 접근하는 방법과 전송 권한 등을 조정한다.<br>
LLC(Logical Link Control) layer : 네트워크 계층 프로토콜을 식별하고 캡슐화, Frame 동기화에 따른 오류를 처리한다.<br>
데이터 단위는 프레임(Frame)이다 : 오류 검출을 위한 checksum, 송수신이 이루어지는 host들의 주소, 제어 코드 등을 포함한다.<br>
Layer 1에서 받은 데이터에 오류가 있다면 Layer 2에서 재전송을 요구하는 방식으로 오류를 수정한다.<br>
브릿지, 스위치 등이 Layer 2에 포함된다.

#### Layer 3 : 네트워크 계층(Network Layer)

라우팅 : 네트워크상의 서로 다른 두 노드간에 패킷을 전달한다. 알고리즘을 이용하여 최적의 경로를 선택한다.(End-to-End-delivery, Host-to-Host-delivery)<br>
IP 주소(인터넷 상의 주소)를 사용하여 데이터를 전달하는데, MAC 주소(실제 하드웨어 주소)를 IP 주소로 바꾸어 사용한다.<br>
데이터 단위는 패킷(Packet)이다 : payload(네트워크가 전달하는 데이터의 형식화 된 블록으로, 제어정보 + 사용자정보로 이루어진다) + header(소스와 목적지 등을 제공)<br>
패킷을 지원하지 않는 경우 바이트/비트/문자열을 연속하여 전송하게 된다.<br>
프레임을 다른 네트워크로 전송하기 위해 한번 더 감싼 것이 패킷이라고 생각하면 된다.<br>
라우터, L3 스위치 등이 Layer 3에 포함된다.

#### Layer 4 : 전송 계층(Transport Layer)

종단 간 신뢰성 있는 데이터를 전달한다.(End-to-End-Reliable-delivery)<br>
정확한 목적지(port)까지 데이터를 전달해주는 역할을 한다.<br>
데이터가 너무 큰 경우 여기에서 세그먼트(Segment)라는 단위로 쪼개서 전송하게 된다(segmentation). 전송하는 데이터는 Layer 4의 header 뿐만 아니라 Layer 3의 header 까지 포함해야 하므로, 보낼 수 있는 실질적 용량은 한번에 최대 전송 가능한 용량에서 이 두 header의 용량을 제외한 만큼이 되고 이것이 곧 세그먼트의 크기가 된다.<br>
도착한 데이터를 재조립하여 Layer 5로 올려보내는 역할 역시 여기서 맡는다.<br>
발신지와 수신지의 port와 순서등을 붙이고 오류 검출을 위한 코드 등을 추가하여 그룹화한다. 순서가 어긋나게 되어도 목적지의 프로토콜이 바로잡아준다.<br>
발신지와 목적지에서의 오류 검출 코드가 다르면 오류가 발생한 것이므로 세그먼트를 폐기하고 복구 절차를 밟게된다. 반대로 오류가 없는 경우 다음 데이터들의 전송이 이루어진다.<br>
L4 스위치 등이 Layer 4에 포함된다.

#### Layer 5 : 세션 계층(Session Layer)

응용 프로그램 간의 논리적인 연결(session)을 생성, 제어, 파괴하는 역할을 한다.<br>
TCP/IP session 역시 여기에서 관리한다.<br>
통신 방법으로는 전이중 통신/반이중 통신/단방향 통신이 제공된다.<br>
데이터의 단위는 data, message가 사용된다.

#### Layer 6 : 표현 계층(Presentation Layer)

데이터 포맷팅과 더불어 응용 계층에서 정의된 포맷으로 데이터를 변환하는 역할을 맡는다.<br>
인코딩/디코딩, 압축/해체, 암호화/복호화 등의 기능을 수행한다.<br>
직렬화 등도 여기서 이루어진다.

#### Layer 7 : 응용 계층(Application Layer)

사용자가 직접 사용하게 되는 계층.<br>
HTTP, FTP, telnet 등의 프로토콜이 존재하고, 이를 쉽게 사용하게 만들어주는 다양한 응용 프로그램들과 통신한다.<br>
email 프로그램이 웹 브라우저 같은 경우 직접 해당 프로토콜과 통신하기 때문에 이 계층에 포함된다.

##### 통신의 종류

- Full-duplex(전이중 통신) : 양쪽 모두에서 데이터 송수신이 동시에 가능하다. 통신선이 2개. WebSocket 등이 포함된다.<br>
- Half-duplex(반이중 통신) : 양쪽 모두에서 데이터 송수신이 가능하지만 송수신을 동시에 하는 것은 불가능하다. 통신선이 1개. 한쪽이 송신하는 동안 다른 한쪽은 수신만 가능하다. 무전기, HTTP 등이 포함된다.<br>
- Simplex(단방향 통신) : 정해진 방향으로만 전송이 가능하다. 통신선이 1개.

#### TCP, UDP

TCP(Transmission Control Protocol) : 전송을 제어하는 프로토콜. IP가 직접적인 데이터를 배달하고, TCP는 이를 추적 및 관리하는 역할을 한다. 연결형 프로토콜로 인터넷 환경에서 기본적으로 사용하며, 3-way handshaking(연결 설정)과 4-way handshaking(연결 해제)를 통해 연결을 설정한다. 높은 신뢰성으로 보장하는 대신 속도가 느리다.<br>

UDP(User Datagram Protocol) : 사용자 데이터를 데이터그램 단위로 나누어 처리하는 프로토콜. 연결을 위한 논리적 경로가 없기 때문에 같은 곳에서 출발한 패킷이라도 서로 다른 경로를 타고 전송될 수 있다. 속도가 빠르지만 handshaking이 이루어지지 않기 때문에 최소한의 오류 검출만이 이루어지고, 신뢰성이 낮다. TCP에 비해 속도가 빠르다.
